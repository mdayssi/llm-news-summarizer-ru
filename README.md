# LLM News Summarizer (RU)

Абстрактивное резюмирование русскоязычных новостей + классификация тональности.  
Пайплайн: **SFT (QLoRA) → Alignment (DPO) → RAG-light**. Стек: PyTorch / Transformers.

## Возможности
- Генерация краткого резюме (3–5 предложений, нейтральный тон).
- Классификация тональности текста.
- Режимы сравнения: Baseline vs SFT vs SFT+DPO.
- (Опционально) RAG-light: подмешивание 1–2 справочных фрагментов для фактической поддержки ответа.

## Данные
- Набор для суммаризации: **Gazeta** — пары «новость → эталонное резюме»  
  https://huggingface.co/datasets/IlyaGusev/gazeta
- Сплиты: `train / dev / test` (фиксированный `test` для итоговых метрик).
- Источник знаний для RAG-light: энциклопедические справки / ru-wiki (используется на инференсе).

## Оценка качества
- **ROUGE-1 / ROUGE-2 / ROUGE-L** + средняя длина резюме.
- Для alignment: A/B win-rate (SFT vs SFT+DPO), показатели опоры на факт-контекст.

## Технологический стек
- **PyTorch**, **Transformers**, **PEFT (QLoRA)**, **TRL (DPO)**
- Эмбеддинги / ретрив: **sentence-transformers**, **FAISS**
- Метрики: **evaluate**, **rouge-score**
- Демо: **Streamlit**

## Структура репозитория
- `data/`
  - `raw/` — большие сырые данные (внешнее хранилище, не в Git)
  - `processed/` — очищенные тексты + эталоны (небольшие версии можно хранить)
  - `splits/` — файлы сплитов (в Git)
- `models/` — веса LoRA/DPO (внешнее хранилище)
- `indexes/` — индексы RAG (внешнее хранилище)
- `metrics/` — csv/tsv с ROUGE и др. (в Git)
- `docs/` — минимальная публичная документация
- `README.md`

## Конфигурация окружения
Сконфигурируйте пути **без** изменения кода проекта — через файл `.env` в корне.

1. Скопируйте `.env.example` → `.env` (в корне репозитория).
2. В `.env` укажите свои пути: `EXTERNAL_STORAGE_DIR`, `DATA_DIR`, `INDEX_DIR`, `MODELS_DIR`.
3. Файл `.env` **не коммитится** (см. `.gitignore`).

## Быстрый старт
1. Клонируйте репозиторий.
2. Создайте `.env` на основе `.env.example` и задайте пути.
3. Установите зависимости (будут добавлены вместе со скриптами подготовки/оценки).
4. Скрипты подготовки данных, обучения и демо будут добавлены в следующих коммитах.

## Лицензия
MIT
